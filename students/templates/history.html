{% extends "base.html" %}

{% block content %}

<div class="container">

    <h2 class="text-center mb-4">Dashboard Overview</h2>

    <!-- SUMMARY CARDS -->
    <div class="row mb-4 text-center">

        <div class="col-md-3">
            <div class="card bg-primary text-white shadow">
                <div class="card-body">
                    <h5>Total Students</h5>
                    <h3>{{ total_students }}</h3>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card bg-info text-white shadow">
                <div class="card-body">
                    <h5>Average Score</h5>
                    <h3>{{ avg_score }}</h3>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card bg-success text-white shadow">
                <div class="card-body">
                    <h5>High Success</h5>
                    <h3>{{ high_count }}</h3>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card bg-danger text-white shadow">
                <div class="card-body">
                    <h5>Low Success</h5>
                    <h3>{{ low_count }}</h3>
                </div>
            </div>
        </div>

    </div>

    <!-- GRAPH SECTION -->
    {% if graph %}
    <div class="text-center mb-4">
        <img src="data:image/png;base64,{{ graph }}" class="img-fluid">
    </div>
    {% endif %}

    <!-- STUDENT TABLE -->
    {% if students %}
    <table class="table table-bordered table-striped shadow">
        <thead class="table-dark">
            <tr>
                <th>Name</th>
                <th>Attendance</th>
                <th>Internal</th>
                <th>Assignment</th>
                <th>Final Exam</th>
                <th>Prediction</th>
                <th>Actions</th>
            </tr>
        </thead>

        <tbody>
            {% for student in students %}
            <tr>
                <td>{{ student.name }}</td>
                <td>{{ student.attendance }}</td>
                <td>{{ student.internal_marks }}</td>
                <td>{{ student.assignment_score }}</td>
                <td>{{ student.final_exam_score }}</td>

                <td>
                    {% if student.prediction_result == "High Chance of Success" %}
                        <span class="badge bg-success">
                            {{ student.prediction_result }}
                        </span>
                    {% else %}
                        <span class="badge bg-danger">
                            {{ student.prediction_result }}
                        </span>
                    {% endif %}
                </td>

                <td>
                    <a href="{% url 'edit_student' student.id %}" 
                       class="btn btn-warning btn-sm">
                       Edit
                    </a>

                    <a href="{% url 'delete_student' student.id %}" 
                       class="btn btn-danger btn-sm"
                       onclick="return confirm('Are you sure you want to delete this student?');">
                       Delete
                    </a>
                </td>

            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <p class="text-center">No student data available yet.</p>
    {% endif %}

</div>

{% endblock %}